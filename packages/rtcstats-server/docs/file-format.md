# RTCStats dump files format speciﬁication

RTCStats dump files are line-oriented JSON as described in [JSON Lines](https://jsonlines.org/)
This section described the file format in version 3.

Breaking changes to the file format require a migration plan.

## Compression
RTCStats dump files may be compressed using standards compression methods such as gzip, bzip or brotli

WebRTC domain specific compression such as method compression or stats property compression
* MUST be supported by importers and
* MAY be used by clients.

getStats delta compression
* MUST be supported by importers and
* MAY be used by clients.
See below for older file formats and upgrading.

## File header
The first line of every file is "RTCStatsDump" followed by a new line and a JSON object with metadata.

At minimum that object MUST include the "fileFormat" property with an integer value specifying the file format version.

## Format
Every line after the metadata object is a JSON array with RTCStats events.

Usually four items (elements) but some methods require more elements.

* the first item is the method name, e.g. `setLocalDescription` which MAY be compressed using a static method table.
* the second item is the peerconnection id or null if this is not related to a peerconnection, e.g. getUserMedia-related events are not associated with a peerconnection.
* Third item is the arguments to the API call or the event. The value type and format depend on the method name. For most events it is either an array with the arguments to the API call serialized as an array. If the method has only a single argument this will be used as-is.
* There may be additional items
* * e.g. a correlation id to associate a call to setLocalDescription with a call to its corresponding setLocalDescriptionOnSuccess
* * For events related to RTCRtpTransceiver or RTCRtpSender an object identifier.
* The last item is the timestamp delta (relative to the previous timestamp or the UNIX epoch for the first event) at which the event was generated by the client, given as a UNIX timestamp.

## Personally identiﬁiable information
Personally identifiable information should be obfuscated where possible.

Servers SHOULD do obfuscation, clients MAY do obfuscation.

This includes but is not limited to
* IP addresses in SDP, onicecandidate, addIceCandidate or statistics.
* device labels from enumerateDevices or getUserMediaOnSuccess

